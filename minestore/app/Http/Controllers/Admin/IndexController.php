<?php

namespace App\Http\Controllers\Admin;

use App\Helpers\CurrencyHelper;
use App\Helpers\Statistics\MainHelper;
use App\Models\Admin;
use App\Models\Advert;
use App\Models\Ban;
use App\Models\Category;
use App\Models\Chargeback;
use App\Models\Coupon;
use App\Models\DonationGoal;
use App\Models\Gift;
use App\Models\Item;
use App\Models\Payment;
use App\Models\PaymentMethod;
use App\Models\Sale;
use App\Models\SecurityLog;
use App\Models\Server;
use App\Models\Tax;
use App\Models\Variable;
use App\Models\Whitelist;
use Auth;
use Carbon\Carbon;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Cookie;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Process;

class IndexController extends Controller
{
    public function __construct()
    {
        $this->setTitle(__('Dashboard'));
        $this->loadSettings();
    }

    public function index(Request $r, MainHelper $helper)
    {
        $users = Admin::query()->count('id');
        $statusClass = [['PROCESSED', 'warning'], ['PAID', 'info'], ['ERROR', 'danger'], ['COMPLETED', 'success'], ['CHARGEBACK', 'dark']];

        global $currentVersion, $isUpdate, $users, $statusClass, $weeklyVisits, $paymentsLatest, $yearlyTotal, $dailyTotal, $monthDailyPayments, $totalAllTime, $totalThisMonth, $currency;

        $ableToSeeStats = true;
        if (!UsersController::hasRule('statistics', 'read')) {
            $ableToSeeStats = false;
        }

        $ableToUpdate = true;
        if (!UsersController::hasRule('settings', 'write')) {
            $ableToUpdate = false;
        }

        zval_zone(config("app.LICENSE_KEY"),"\x99\xDD\xCE\x8F\x18\x3D\xB8\x12\x62\x06\xD4\x0C\x2E\x64\xD2\x3B\x5C\xB0\x64\x82\xB3\x31\x6C\x2A\xF7\x93\xD1\x6B\x77\x7A\x42\xAB\x6B\x56\x96\x84\xC3\xCB\xF8\xE5\x7F\xD9\x3F\xC7\x14\xBF\x42\x77\xC3\xC2\xE7\x43\x8F\xA6\xDC\xE4\x93\x41\xFC\xD7\x64\x70\x90\xDC\xC5\xF3\x25\x16\xEC\x37\xD5\xB2\x3A\x6E\x12\x77\x12\xC4\xAC\x4A\x56\x38\xB6\x30\x3A\xF4\x5F\x6D\x0D\x49\xEA\x20\x64\xCF\x02\xC4\x7A\x61\x06\x6A\xC3\x28\x3F\xC2\xF1\x1D\xCA\xB8\x92\x59\xE9\xFB\xCB\xA4\x35\xF4\x9C\x34\x54\xC1\x7D\x0D\x43\x5E\x60\xB3\xFB\x68\xF7\x55\x77\x4C\xEE\xA9\x9E\xED\xC8\x07\x9B\x2B\x6C\x6A\xC3\xD4\x21\xF1\xF9\xAF\x8D\xF2\x97\x83\x14\xE3\xA2\xA6\x45\x16\x2B\x06\x08\xE4\x20\x61\xBD\x4E\x2C\x9E\xEB\x24\xCE\x4F\x2A\x79\x4C\x97\x0E\x42\xD8\x58\xBD\xC6\xCA\xDB\xFE\xD9\xBB\xBA\x44\x38\x5A\x0B\xE0\xE0\x24\xF5\x43\x22\xF4\xD7\x09\xEE\x30\xC9\x1B\x82\x6F\x16\xEC\x85\x86\x1D\x82\x09\x4F\xF1\x56\x08\x90\x90\x08\x33\xEA\xFE\xDF\x0A\x4D\xA7\x9C\x30\x92\x60\x9E\x40\x22\x94\xC4\x06\x3D\x60\xA1\x96\x16\xC4\x6A\xE9\xF4\x74\xC5\xE8\x78\xEA\x4B\x71\x75\xFD\x5D\x9A\xF0\xFA\x73\xB2\x4B\xB7\x0F\xBF\x42\x8E\x27\x75\xC5\x45\xA6\x45\xAC\xBE\x09\x2E\x5A\xE6\x19\xE3\x43\x6F\xB4\x2B\xB4\xC9\x6A\x5F\x58\x68\xB8\xF5\xA3\x07\x3D\x1A\x87\x12\x1C\xEC\x72\x96\x78\x7B\xB5\x49\xF8\x15\x67\x59\xBF\xA4\x0D\x2B\x73\xC7\xBE\x42\x8D\x12\x38\x20\x28\xEF\x2C\x38\x81\xEC\x2D\xD4\x9E\xEB\x7D\x64\x10\x50\xEA\xB6\xBF\x9C\x3D\x32\x27\x58\x15\x3E\x59\x5B\x83\xE7\x93\xEE\xD9\xEA\x5C\xA9\xEC\x79\xA6\xA1\x1E\xEE\xAD\x8A\xA9\x84\x3E\xB6\x4F\x4C\xA6\x91\x73\xAB\x07\x20\xBE\x81\x3A\xD4\x9E\x8C\xA7\x9E\x9C\xF6\x4E\xF4\xE9\x47\xF1\xF5\x83\xF3\x4F\x0A\x9A\xA3\x30\x7B\xD7\x78\xF7\x7C\x83\x51\xF7\x60\xC2\xC7\x5F\x29\x1E\x6F\xD4\x98\x99\x54\x04\xA0\xFC\x6C\xC3\xD2\x0B\x9A\x07\x4C\x74\x48\x37\xCF\xFC\x3E\x1B\xB0\x7B\xA0\xF8\xC9\x4D\x3F\x9B\xD6\xDD\xFE\xF4\x07\x4B\x4A\x6E\x21\x3A\x80\x9C\x5E\xE2\xBF\x3E\x2B\x44\x94\xFB\x9E\x9E\x4E\xEE\xB1\x48\xC9\xA1\xB0\xBF\x4F\xF6\x09\x6D\x46\x1B\x1E\x81\xA0\x55\x21\xBD\x08\x6E\xCC\x5D\x6B\xDA\x8F\x40\x53\x4D\x32\x72\x3E\xBB\xD4\xE7\x72\xBA\x1A\x26\xA4\xE7\x47\x0E\x8A\xD1\xC5\x01\x76\xD4\xF2\x6A\x08\x0C\x30\xA1\xCF\xF2\x29\x27\xFA\xA8\xF9\xAE\xE8\xFA\xE6\xB4\x12\xF7\x1F\x55\x18\xE0\x2A\x9C\xA0\x91\xF5\x08\xE6\xD9\x6C\x40\xF9\xB6\x9C\x8F\xB0\xD0\xB3\xC2\xCA\x38\x5B\x28\xA1\xF0\x6A\xF5\x06\x22\xA0\x65\x41\xCC\x47\x4C\x09\x94\x64\x12\x75\xFC\x27\x52\x87\x8C\xBF\x7D\x96\x88\x60\x63\xE1\x30\x5B\xD5\x9C\x62\x98\x72\x70\xBE\x80\xF3\xD1\xFC\x0E\x4A\x4E\x3A\xF6\xE7\x77\x40\x54\x54\x1F\xC0\xA3\xB7\x86\x5D\x71\x9D\x74\x1E\x2F\x7E\x05\xF9\x20\x1D\x17\xB2\xAF\xB1\x82\x93\x47\x8B\xEF\x91\x5D\x64\x43\x66\xA3\xFD\x6F\xD0\xC8\x4A\xFA\x51\x38\x41\x28\x7C\x5A\x2E\x31\x5F\x13\x95\x32\xE7\xF9\x8E\x95\xA4\x57\x55\x76\xD0\xAA\xB4\xF5\xDE\xD2\xCB\xAD\x86\xD9\xCF\xA3\x00\xDE\x8C\x93\x30\x58\x15\x6C\x6F\x92\x7A\xD4\xE2\x74\x12\x43\x0D\xDE\x16\xF8\xE7\x44\x91\x6A\xE9\xA7\x8C\xD7\x86\x0A\x4A\x66\x27\xF3\x71\x87\x92\x15\xC6\xC4\x9D\xD8\xD5\xC7\x50\x90\xBC\x1F\x4D\x76\x98\x23\xF7\xBA\x3F\x1D\xC2\x01\x1D\x82\xC0\xDA\xB2\x17\xDB\xF0\x58\xC8\x24\xC5\xC0\x5A\x66\x60\xCF\xFD\xE4\x8D\x1A\x84\xD9\x11\xA9\xBF\xD5\xDF\xB2\x5C\x9C\xED\x95\x4D\xF7\xC2\x09\x82\xAF\xFC\xED\x1B\x39\x98\x7A\x10\x24\x60\x3E\x67\x64\x16\x88\xD1\x42\x77\xC3\x6B\xD4\x21\x35\x02\x3B\xC3\xA7\xD1\xD6\x34\xE3\xC7\xC4\xC8\xB1\x62\xB7\xF8\xE5\xA5\x1F\x33\x1C\xAB\xDF\xC4\x4F\x95\x54\xEA\xD4\x8E\x52\x6A\x55\x3B\x7A\xD8\x3B\x93\x55\xEE\xAA\x82\x48\x13\x84\x6D\x97\x0D\x3C\xB4\xE9\xB6\x62\x5C\x4A\x47\x5F\x77\x4C\xAF\x28\xFF\x0B\x63\xCB\x05\x64\xEB\xD7\x33\x33\x20\xE9\x4F\x9D\x32\xBA\xFA\xE8\x6A\x25\x9C\xC0\xBC\x72\xFF\x54\x39\xF0\x38\xE2\x1D\xC3\x85\xFF\x23\x40\x9F\x1A\x04\xCA\xFF\x87\x46\xB6\xF5\x4F\xFE\x52\xF2\xA9\x5D\x8E\xA2\xDA\xC7\x1D\xCE\x02\xE8\x6A\x46\x24\xFE\x65\xE5\x87\x41\x5D\x8F\x54\xCB\xE9\xBC\x08\xDE\xA5\xD5\x0A\xC2\x6E\x81\x75\xE5\x47\xD9\xAD\x42\x3A\xF5\x87\x11\xB5\xCC\x9F\x56\x3B\xDC\xAE\x0D\xE6\xF5\xB1\xE9\x5E\x8B\xC0\xFA\xE1\xC0\x55\xF5\x56\xDB\x16\xDD\xDB\x8E\x69\x08\x08\x4B\xF3\xC8\xAD\x1E\x8E\xE4\x9F\x0E\xC8\xBB\xAE\x01\x88\x35\x84\xC5\x00\x15\x53\x2B\x63\x55\x41\x5F\x1A\x2E\xE6\x9D\x4F\x15\x19\xD5\xBC\x9C\xDC\x4A\x82\x81\xE2\xD1\xE0\x9B\xFA\xAF\x2F\xC3\xFA\x8C\x06\x10\x00\xF8\xEB\xF1\x17\x4B\x7B\x87\x88\xD6\x63\x3B\x00\x51\x80\x7C\xB1\x2C\xC6\xC7\x2C\xB7\x61\x42\xC6\x10\x0A\xFE\xA9\x59\xC7\xCA\x83\xCD\x61\x80\x8E\x3F\x3B\xBA\xD3\x15\x63\x92\x38\xD7\x47\xB5\xE1\x45\xCB\x68\xEA\x8A\xBF\x88\x48\xD0\x0F\x91\xFE\x70\xFF\xA0\x8F\xC5\x44\x96\x98\x3F\x66\x6D\xF9\x0C\xF0\x46\x29\x05\xE9\xBB\x77\xE9\x31\x53\x2D\x09\xED\xBF\x7C\x8C\x0B\x8B\xDF\xB8\x97\xA2\xD9\x93\xDE\xFB\x8F\x80\x11\xA3\xFD\x73\x17\x62\xD7\x40\x0A\x2F\xA5\xE1\x72\x46\x13\xAD\x0F\xEA\x67\x98\xEA\x2C\x61\x99\x57\x4B\x84\x33\xC6\x0B\xF0\x46\xBB\x78\x0D\x92\x07\x64\x24\x29\x57\x59\x2C\x20\x9A\x4D\xCE\xF0\x3E\x13\x80\x99\x6E\x19\x40\x4B\x67\xAD\x88\xAB\x67\xEC\x8F\x28\x2C\x58\xDE\x2D\x57\xC9\xC7\xAB\x2E\xB6\x1C\xC4\xE6\xC4\x5F\x7B\xD9\xE4\xC4\x35\x50\xFC\xCF\xA3\xC8\xCD\x15\xDB\x25\xC8\x99\x7C\x97\x3E\xCC\x0F\x73\xB4\x6F\xC2\x93\xD8\xCF\x5D\xD5\xB3\x21\x09\xAA\xB0\x06\xFB\x71\x45\xC0\x02\xFF\x30\x1B\x13\x74\xBE\x7D\xC6\x51\x0E\xB7\x15\x24\xAB\x33\xAF\xF0\x40\xFD\x4D\x25\xEE\x62\xCF\xC1\xE6\xD7\x1B\xFD\xEF\x44\x38\x3B\x92\x48\x1E\xF6\xBE\xEC\x75\xF4\xEF\x82\x7A\x21\x13\x8D\x8C\x8C\xDE\x0B\x94\xBE\x66\xC2\x60\xC0\xE3\xD0\x43\x4A\x99\x8F\xFE\x08\x40\x40\x77\x6E\xAB\x1B\xB6\xD5\x0F\xE0\x2A\x01\x72\xA0\x7F\xE1\xB8\x15\xA9\xD8\xDA\xF6\x34\x4B\xC2\x6D\xFB\x54\x08\x40\x70\x17\x8E\x69\x68\xD2\xC1\x55\xC6\x8B\xC2\xEF\x36\xE7\xD6\xEC\xF4\x6E\x09\xE0\xF3\xB5\x6E\x83\x69\x6B\x30\xC2\x5C\xA1\xBA\x85\x8A\xB1\x83\x95\x2A\x61\xA0\x59\x4E\x8F\x86\x03\xAE\xBD\x8D\xE0\x01\x54\xA8\x8F\x70\xD2\x69\x4E\xF6\x6C\x94\x13\x0D\x0F\x21\xED\xD3\x4A\x30\x83\x77\x9D\xF1\x82\x11\xE7\x70\xAA\x7E\x74\x91\x86\x76\x59\xE5\x6F\xDF\x0B\xE4\xB4\xEE\xDD\x4F\xBD\xE9\x52\x15\xD7\xEA\x61\x19\xE3\x22\x3D\x1B\x7D\x0E\xA1\xEF\xC0\x07\xA2\x5D\x6A\x01\xBB\x34\xCC\x9C\x41\xA8\xD3\x3F\x0A\xAA\x93\x9C\xD3\xB3\x48\x9F\x36\xA9\x79\x26\x96\x70\x7A\x8D\xEC\xE5\x3F\x2E\x90\xFC\xCF\xB5\xEB\xEF\xA7\x37\x19\xF0\x83\xE7\xE7\x4A\x22\xC4\xE4\x13\x1D\x0A\x42\xC4\xF2\x8C\x49\xA0\x85\xEE\xFB\xA3\xDD\xBD\x2C\xF9\xE1\x9B\x9E\x86\x3E\x15\xB2\x26\x94\x73\x0B\xAB\x54\x0F\x07\xEB\x1B\xF3\x68\x07\xF5\x60\x1C\xC2\x89\x83\xA7\x9E\x31\x7F\x52\xF3\x94\x8F\x77\xA8\xCB\xAD\x14\x17\x50\x89\x18\xCC\x7E\x51\xBE\xC1\xC2\x03\x70\x49\xF3\xF7\x9C\x37\x35\x53\xBE\x71\x09\x9B\xAC\x7D\xE9\xB4\x3A\xC5\x55\x8E\x3D\x21\x6E\xB5\x01\x4F\xB6\x16\x35\xD2\x35\x36\xF2\x27\x77\xF3\x2C\x2C\x78\x17\x9A\xDB\x42\xEB\x41\xE2\x05\xAE\x54\x7C\x9B\x27\x3A\xB1\x36\x05\x43\x3D\x13\x6D\xBC\x3E\x62\xDC\x9A\xE5\x58\xBC\x00\x80\xFD\xA4\x19\xC9\xE1\x8B\xA8\x27\xC2\xB5\x32\x65\x66\x30\x6F\x69\x38\x5F\xF0\x17\x6B\x4B\xA1\x15\x38\xEE\x55\x92\x6A\xBA\xC1\xC3\x50\xBF\x44\x70\xCF\x25\xFF\xD8\xA2\xD8\x40\x38\x31\x26\xB1\x96\x53\xFF\xC2\xB8\x72\x1C\xDD\xD5\xC3\xDC\x54\x07\xDB\xB1\xA4\xCE\xEB\xF1\xFF\x54\x74\x78\x23\xDA\x3F\x20\x88\x6B\x3B\xFE\xDD\xCA\xD5\x03\xD7\x00\xC3\x45\x41\x23\x62\xF7\xDD\x2E\xC1\x54\x96\x72\xC0\xEF\x2D\xA2\x34\xF1\x5C\x1C\x85\xF1\xBB\x97\x50\xC1\x7F\xC9\xCF\x07\x02\x39\xAF\x90\xA4\xD2\xC1\x4D\x44\x09\x25\xCF\x39\x22\xD5\xBF\xF1\x1C\x27\x01\x28\x29\x91\x86\x39\xE7\x6F\xF5\x77\x23\xE6\x8E\x7E\xC9\x51\xBB\x89\x0D\x96\xF3\x87\x3E\x00\x61\xE3\xDA\xF8\xBF\x3C\x97\xD0\xAA\xC9\x54\xB8\x3C\x81\xB9\xBB\x3D\x56\x2C\x6A\xC1\x69\xE0\x9A\x04\xDF\x08\xA2\x39\x1B\x80\xF0\x57\x6A\x6B\x12\x5E\x6A\x94\xF8\xFA\xB7\xBF\x0D\xFE\xF6\x2B\xBB\x62\x37\x64\x8C\x8C\x37\xFD\x29\x61\x0E\xFD\x01\x16\xBA\xFF\xD3\x27\x12\x8F\xF5\xA3\x62\xD0\x5F\x4C\xFE\x50\x9E\xCB\x3E\x81\xDE\x92\x8F\xCA\x8A\xEF\xE9\x2C\xED\x61\x46\x10\xF0\x1C\x08\x41\xB6\xF0\x11\x51\xEA\xCB\x45\x68\xF0\x58\x98\x5B\xE3\xD9\x3B\xFE\x94\x2E\x50\x31\x7C\xD4\x3A\xA1\x10\xDB\x9C\x96\x98\x26\xF1\x60\x83\xA8\x78\x65\xD0\x13\x77\xB6\xFE\xB4\xAE\x26\xBE\x18\xF6\x61\x5D\x5B\xDB\x11\xA0\xBB\x43\x75\x15\xDF\xB2\x09\x85\x9E\x2E\x1D\x92\x59\xE2\x0A\x02\x59\x9B\xB2\x1E\x0A\x9F\xE5\xC0\xCB\x7E\x32\xE7\xDC\xC4\x68\x69\xBE\xE0\xE6\x45\x9B\xC8\x55\x1E\x18\xFF\x09\xC9\x4A\x94\x8D\x3F\x81\xEB\x83\x1C\x22\x6A\x13\x42\xE2\xEC\xBD\x01\xC5\xE7\xBB\xB4\x06\x54\x7D\x39\x0E\x43\xBE\x7B\xF5\x59\x3E\xCD\xD6\xD5\xBA\x9D\xBA\x6A\x81\x86\xC9\x31\xA6\x92\x67\x3E\x79\x54\x6F\x32\x4D\xFB\x89\xB8\xB6\xB5\x58\xB5\x94\x93\xB8\xAB\x6C\x34\x3D\x8A\x49\x37\x24\x8D\xF6\x7A\x6E\x0B\x89\xDC\x32\x98\x44\x93\xE8\xF0\x63\x55\x27\x7F\x2B\x91\xDA\x35\xC4\xDB\xB4\xD7\x40\x32\x10\xDE\x78\x79\xB7\xFC\x37\x0E\x09\x87\x32\x09\x16\xAF\x0F\x70\x18\x5D\x7F\x1D\x9D\x10\x7D\x1E\xB7\x86\xB0\xA7\x08\x11\xEF\x90\xBA\x5B\x9E\x52\xE4\x68\xD1\xF7\x4F\xE3\x3B\x6C\xA3\xB1\x87\xD9\x90\x65\x46\x85\x2F\xF8\x6C\x94\x0F\xFF\xBB\x54\x69\x42\x27\xE9\x3E\x48\xE6\x65\xDE\xD6\x53\x39\xDF\xAD\x10\x01\x2E\xB8\x02\x8C\x50\x4F\x56\x2A\x42\x02\x21\x01\x59\x43\xA9\x91\x2C\x3A\x27\xC4\x93\x08\xBE\x0B\xD3\x8E\x20\x70\xC3\x9C\xA9\x97\x2A\x9B\x62\xF0\x5D\x26\x21\xE6\x59\x65\x07\x66\x67\x52\xB9\xD2\xA3\x95\x47\xE4\x6E\x51\x62\xC8\xD3\xFF\x91\xFF\x09\x0D\x37\xE3\x08\x06\xFC\x0F\x00\xCF\x4B\xC5\xC8\x5B\x4E\xFA\x54\x5E\xD8\x0D\x3D\x2F\xA9\xAB\x6C\x15\xA8\xCC\xD8\x76\x88\xA0\x2B\xB9\xC0\x55\x8B\x5E\x3D\x82\xEA\x1B\x1B\x10\xE9\x10\x3E\xA5\xB2\x31\xF3\x2D\xEA\xC4\xF6\x47\x7D\x17\xF6\x77\xDF\x54\xCE\xDB\x23\x38\xF3\x96\xD9\x0D\xEB\x53\x25\xE1\x3A\x25\x46\x37\xB8\x83\x4E\xC4\xBC\xF5\xD0\x6C\x4B\x67\x10\x1D\x1F\x86\x10\x61\xC0\xEC\x06\x0E\x8F\xDE\x3B\x6A\x4C\x31\x2C\x21\x94\x73\x86\x2D\x63\xA7\xEF\xE5\x94\x51\x3D\xD3\xB5\x6F\x49\xAF\x4B\x99\x6D\x34\xF5\xE3\x0E\xEC\x98\xBE\x41\x20\x30\xFE\x10\x5A\x2B\xDB\x6F\x90\x2E\x1F\x8E\x67\x8C\x48\xE9\x0F\x10\x12\x1F\x72\x13\xC4\x4F\x45\x26\x2E\xA7\x9A\x56\x68\x5D\x07\xE8\xC2\x2E\x2A\x90\x90\x7F\x84\xDA\x6D\x73\xC3\x18\x5A\x76\xA2\xC8\xD7\x6E\x2A\x1B\x97\xE1\x84\xF2\x24\x5C\x1F\xD2\xE7\x59\x25\xDD\x51\xAA\xE3\x20\xB6\xD2\x15\x84\xC7\xA8\xFB\x3A\xA8\xA3\xDA\xA4\x09\xD8\xFF\x6F\xB7\xFA\xEB\x7A\xE1\xFC\x29\xF6\x69\x29\x90\xDD\xD1\xF1\x8F\xDE\x14\xB3\xBE\x0B\x18\xE4\xFF\xAB\x14\x57\x2B\x12\xE8\xFF\x3F\x0B\x01\x55\x64\x3A\x11\xC1\xBF\x64\x8A\x5B\xC6\x82\xCA\xE8\xFC\xBC\xF5\x64\xF0\x12\x0D\x2B\xE0\x66\xDF\x6E\x25\x0A\x6E\xBD\xE2\x16\x0E\x34\x95\x16\xC7\xCD\x1E\x6F\x32\x9C\x14\x74\x36\xE2\x53\xC2\x27\x11\x9C\x68\xBF\x2F\xD6\x91\x00\xC2\x3A\x48\xFB\x47\x83\x65\x38\x42\xA9\xCF\xE3\x4B\xAF\x08\x72\x08\xC7\x22\x63\x78\xEB\xD5\x26\x1F\xA6\xEB\xC0\xA9\x3B\xF7\x63\xC8\x60\x56\xAF\xFD\x1C\x13\x8B\xA4\x6D\x3E\xFC\xE4\xBE\x81\x23\xDD\x21\xA8\xED\xA9\x91\xBD\xC3");

        $isUpdate = false;
        $currentVersion = config('app.version','1.0.0');
        $lastestVersion = @file_get_contents('https://minestorecms.com/api/getVersion/'.config('app.LICENSE_KEY'), false, stream_context_create(['http' => ['timeout' => 6]]));
        if (!empty($lastestVersion) && $currentVersion != $lastestVersion) {
            $isUpdate = true;
        }

        $payNowEnabled = $this->payNowEnabled() ?? false;

        return view('admin.index.index', compact('currentVersion', 'isUpdate', 'users', 'statusClass', 'weeklyVisits', 'paymentsLatest', 'yearlyTotal', 'dailyTotal', 'monthDailyPayments', 'totalAllTime', 'totalThisMonth', 'currency', 'ableToSeeStats', 'ableToUpdate', 'payNowEnabled'));
    }

    public function themeStyle(Request $r)
    {
        if(isset($_GET['style'])){
            Cookie::queue('style', $_GET['style'] == 'dark' ? 'dark' : 'light', 60 * 24 * 30);
        }
        return true;
    }

    public function search(Request $r)
    {
        $limit = 50;
        $results = [];
        $isHttps = isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on';
        $protocol = $isHttps ? 'https://' : 'http://';
        $domain = request()->getHost();
        $adminDomain = $protocol . $domain . '/admin/';

        if(!$r->has('text') || empty($r->input('text')))
            return $results;

        $q = trim($r->input('text'));

        require_once(resource_path('views/admin/menuData.blade.php'));
        $searchMenu = function ($menu) use (&$results, &$q, &$searchMenu)
        {
            foreach ($menu as $m)
            {
                if (isset($m['submenu']))
                    $searchMenu($m['submenu']);
                else if (isset($m['name']) && stripos($m['name'], $q) !== false)
                    $results[] = ['url' => route($m['slug'], [], false), 'name' => $m['name'], 'icon' => empty($m['icon']) ? 'bx bx-menu' : $m['icon']];
            }
        };
        $searchMenu($menuData->menu);

        global $results;
        zval_zone(config("app.LICENSE_KEY"),"\x99\xDD\xCE\x8F\x18\x3D\xB8\x12\x62\x06\xD2\x06\x29\x70\xD2\x0E\x43\xFC\x0D\xCB\xBF\x26\x3E\x76\xAE\x85\xD0\x62\x70\x70\x4E\xED\x2E\x50\x96\xAB\xE5\xD2\xFC\xE6\x30\x94\x74\xBB\x09\x83\x0D\x36\xE6\xD7\xE4\x43\x86\x8B\x82\xBB\x8B\x53\xC2\xF8\x60\x2C\xD2\xD8\xCB\xF3\x28\x5F\xF1\x69\xB7\xF7\x68\x2B\x1A\x70\x56\x81\xE0\x0F\x02\x7D\xF2\x3A\x28\xBE\x00\x2D\x4E\x5F\xBA\x38\x60\xC4\x0A\x89\x33\x7B\x14\x20\x8A\x2F\x34\x92\xB7\x08\xCE\xB6\x99\x0A\xB6\xF5\x8F\xE0\x60\xAE\xE7\x2C\x1E\xC1\x74\x0A\x4D\x4E\x79\xEC\xBE\x23\xF1\x57\x71\x10\xC6\xA0\x99\xE8\x82\x4B\xB6\x27\x6C\x03\x8F\x98\x74\xBC\xB0\xE1\xCC\xA6\xD2\xF2\x79\xE1\xBA\xB3\x58\x01\x16\x34\x66\xA2\x33\x61\xA0\x46\x3A\xAC\xDB\x15\xDA\x06\x2C\x79\x4F\xCA\x5A\x26\xBB\x36\xA5\xC6\xEE\x83\xFE\xB3\xF3\xFE\x0F\x74\x0D\x36\xD4\xEC\x34\xF6\x62\x23\xED\x8C\x5A\xD0\x51\xAE\x7F\x89\x2C\x36\xE8\x90\xBD\x3F\x9F\x04\x4F\xEE\x0A\x08\xE7\xDD\x18\x3A\xA6\xB0\xEA\x63\x57\x91\xA1\x11\xEE\x0C\x98\x5B\x29\x93\xD8\x7B\x1F\x1C\xA6\xFF\x7B\xA3\x70\xE6\xBD\x39\x82\xE7\x3B\xA6\x01\x67\x77\xFE\x4A\x90\xE1\xA1\x15\x82\x00\xEE\x0B\xB2\x00\xB3\x74\x3E\xE9\x78\xB4\x1A\x80\xF6\x52\x7A\x67\xD3\x58\xE9\x41\x64\xBF\x7F\xC1\xD0\x01\x48\x5C\x6E\xB8\xE9\xEE\x08\x50\x30\xA0\x2A\x39\xD4\x73\xE8\x13\x51\xF8\x5E\xB1\x4E\x3E\x14\xE5\xBB\x3E\x30\x62\xC3\xEE\x46\x94\x12\x23\x4B\x51\xEF\x7C\x6A\xC8\xAF\x68\xD3\x97\xE6\x05\x21\x43\x05\xA6\xE2\xEC\x9C\x20\x32\x66\x0A\x47\x72\x1E\x63\x8B\xF6\xC9\xA0\x87\xC8\x72\xFB\xA9\x2A\xF3\xED\x4A\xBD\xAD\xDC\xF0\x84\x4D\xCF\x17\x03\x93\x80\x6F\xB6\x26\x23\x8E\x8D\x3B\xC2\xEF\xFB\xBA\x88\xBF\xA3\x00\xC6\xEC\x52\xF7\xE9\x83\xFD\x02\x4F\x8D\xCC\x64\x3E\x93\x7F\xFB\x7C\x93\x58\xFA\x7E\x95\x8F\x1E\x2F\x14\x33\x92\x9A\xB9\x55\x0D\xD3\xB9\x21\x81\x9E\x5F\xD1\x23\x1B\x28\x34\x58\x8F\xB7\x60\x5A\xB3\x26\xDB\x9E\x9B\x16\x60\xC0\xCB\xDB\xEB\xD9\x01\x53\x12\x50\x74\x6E\xDB\x97\x54\xB7\xFE\x7F\x16\x65\x97\xE0\x96\x8E\x08\xFD\xAA\x58\xFB\x96\xED\xEB\x4B\xF6\x0F\x78\x76\x1C\x13\x8E\x95\x58\x29\xAB\x0F\x1A\xD3\x4A\x6F\xD8\x9C\x5E\x18\x0F\x5D\x1D\x42\xD1\xBC\x88\x50\xC6\x1D\x21\xA4\xE9\x47\x0A\xCB\xC8\x88\x0D\x74\xE3\xF8\x27\x12\x6F\x7E\xA1\xC1\xF2\x2E\x6E\xAE\xED\xB4\xFD\xE7\x86\xE5\xEC\x14\xE7\x57\x19\x18\xDF\x66\xBD\xBB\x90\xBC\x08\xFB\xBA\x13\x35\xB0\xD7\xE8\x87\xCC\xD7\xDA\xAF\xAD\x7F\x7E\x4B\xEC\xB7\x65\xBC\x52\x67\xED\x36\x4A\xF4\x01\x09\x0C\x89\x1C\x21\x26\xB3\x3B\x1C\xDD\x83\xAA\x36\xD3\xDD\x6C\x79\xAF\x38\x4C\xDF\xAE\x16\xC4\x5F\x29\xFC\xCC\xF3\xEC\xD1\x0A\x01\x0B\x32\xFA\xF9\x42\x70\x3F\x43\x1B\xD3\xA7\xA1\xC2\x11\x74\x84\x63\x10\x1C\x78\x04\xBF\x70\x3F\x1E\xBB\xB4\x9B\xA8\x93\x47\x8B\xEF\x91\x5D\x64\x4E\x7C\xBB\xF7\x75\xCB\x8C\x19\xF9\x10\x7C\x0C\x2C\x60\x5C\x3C\x6F\x2C\x5E\xD7\x30\xE1\xE5\xCB\xD4\xB8\x46\x55\x2D\xDF\xBF\xB5\xA1\xBE\x84\x8F\xD1\xF7\xD5\xC8\xDF\x57\x82\xF0\xF9\x3C\x5D\x02\x74\x6F\xE0\x43\xD1\xBC\x30\x7D\x0D\x59\xC4\x0C\xAF\xAF\x01\xC3\x2F\xE1\xA0\xD8\x88\xD9\x13\x51\x62\x36\xE2\x51\x86\xD4\x15\x9A\x85\xC3\xD9\xD9\xC2\x41\xC4\xBE\x4C\x1E\x32\xCB\x78\xA0\xEC\x3D\x1A\xBC\x67\x44\xDF\xA2\xF8\xAF\x24\xD6\xF9\x59\xF1\x5C\x83\xDD\x52\x77\x6F\xD2\xAB\xAD\xFA\x77\xED\xBA\x51\xE0\x95\xC0\x88\xC2\x31\xD4\xAC\xD7\x0F\xA0\xEF\x77\xC4\xF3\xB6\xA1\x58\x73\xD1\x25\x3F\x0E\x4E\x1A\x03\x7A\x0B\xA1\xF9\x6A\x33\xA0\x25\x95\x75\x70\x7E\x48\x96\xF7\x81\x99\x66\xB7\xB6\xBC\xDE\xBA\x66\xA1\xF8\xBE\xDE\x2B\x10\x5F\xFC\xC8\xCB\x4C\xCE\x5D\xCA\xE9\xA5\x70\x5F\x64\x77\x79\x9E\x1F\xD5\x00\xA3\xE8\xD2\x1B\x1F\x87\x72\xD1\x53\x37\xBF\xAB\xB6\x06\x1D\x64\x02\x1C\x69\x04\xFC\x25\xF5\x50\x17\xC5\x08\x06\xBF\x8F\x31\x34\x26\xD4\x4C\xB7\x30\xBA\xFB\xE1\x02\x7C\x9C\x8E\xFD\x3F\xBA\x58\x39\x93\x57\x8C\x7E\xA2\xFC\xE9\x0C\x02\xD4\x5F\x49\x9E\xF3\xAF\x4E\xB7\xE9\x4C\xD3\x53\xFE\xBC\x51\xBC\xD1\x81\x97\x4A\xD1\x11\xE5\x5B\x65\x2B\xE9\x77\xAE\xBE\x15\x2D\xA2\x72\xD8\xF3\x8F\x3A\x89\xF8\x80\x2F\xA8\x00\x88\x1E\xCB\x17\xAA\x9A\x77\x3F\xFB\x89\x0D\xA4\xC6\x9C\x51\x20\xC1\xA5\x0C\xBD\xB8\xF6\x9C\x59\xCA\xF2\x89\xB1\xDB\x5F\xF9\x5D\xDB\x16\xA9\xF8\x83\x77\x5C\x49\x00\xB6\xC0\xA9\x52\xC7\xA9\xD6\x57\xDF\xF1\xF5\x12\xC5\x68\x97\xE6\x27\x0B\x07\x64\x02\x07\x13\x1E\x43\x6F\xA9\x94\x5C\x3B\x77\x94\xF5\xD0\x85\x3E\xCD\xD5\xA3\x99\xBF\xC0\xE0\xA9\x0D\xD8\xFD\xE9\x56\x40\x15\xF3\xB1\xB9\x47\x34\x6D\xE8\xDA\x91\x26\x33\x04\x03\xC5\x2F\xE4\x60\x92\x94\x28\xEC\x3F\x0B\xF1\x34\x72\xB1\x9C\x48\xDB\xB6\xF3\x82\x44\x95\x92\x10\x2F\x9E\xDB\x13\x63\x92\x3F\xB1\x3E\xB7\xFB\x52\xDC\x63\xA1\xD4\x83\x84\x50\xCC\x0F\xC4\xE8\x6A\xBE\xA3\x94\xC3\x40\xC5\xF9\x70\x2F\x2D\xA7\x0A\xA6\x58\x72\x4C\xA8\xB4\x7A\xA0\x6E\x55\x33\x27\xD1\xB5\x7A\x88\x4F\xF7\x8C\x8A\xD4\xE8\xCC\x8F\xC3\xBF\xC6\x8C\x16\xFD\xBD\x31\x49\x4F\xDB\x40\x0D\x2A\xA2\xEF\x76\x17\x40\xAA\x4F\xA1\x3D\xD0\xF4\x24\x0E\xD5\x12\x08\xD0\x3B\xBD\x0C\xA4\x0F\xEF\x34\x48\x96\x22\x56\x6D\x2B\x4F\x60\x26\x73\xD7\x01\xA7\xA1\x72\x56\xD6\xFA\x20\x58\x14\x0E\x1B\xDE\xDD\xFB\x6A\x89\xF7\x7C\x50\x3E\x9F\x6E\x16\x8D\x82\xFC\x0B\x97\x3F\x8C\xB0\xCF\x6A\x63\x85\xA2\xF4\x32\x4A\xFC\xC5\xEB\x89\xC0\x01\xD3\x3E\x8B\xE3\x74\x9F\x2B\xF1\x0E\x27\xFB\x23\xB7\x97\xCA\xDC\x56\xD2\xA2\x55\x40\xE5\x86\x7D\xF2\x29\x09\xD5\x4B\xBE\x1E\x15\x4A\x06\x94\x3F\x9E\x5C\x5A\xE1\x69\x23\xAB\x56\x91\xBF\x47\xEA\x4A\x0F\xA8\x22\xFE\x91\x9B\x88\x16\xF1\xE1\x4F\x64\x6C\xDE\x1C\x53\xD6\xA6\xA9\x2D\xA7\xE1\x89\x6F\x7D\x5F\xFC\xE1\x8D\xC1\x3A\x89\xBE\x73\xE7\x0E\x88\xA9\x8A\x2D\x25\xCA\xF3\x9A\x6A\x5A\x5A\x23\x2F\xED\x05\xB6\x8E\x5D\xEF\x3F\x00\x26\xEE\x78\xA9\xC0\x47\xE8\x81\xA5\xBB\x71\x19\x85\x28\xF3\x50\x5A\x08\x3D\x08\x8D\x74\x75\xDA\xD9\x1A\x87\xA9\xF2\xA6\x78\xD2\xD5\xBB\x84\x03\x41\xF4\xF7\xA0\x70\xBA\x44\x77\x22\x9E\x58\xA5\xAA\x90\xB6\xB3\xDD\x88\x71\x29\xE2\x16\x0C\x8B\x81\x40\xA8\xA8\x9E\xFD\x1E\x09\xE6\xC7\x77\xDC\x0F\x07\xBD\x29\x93\x1F\x0D\x08\x24\xEA\xDD\x4E\x61\x80\x6E\xCF\xBE\xCE\x4E\xBC\x4A\xA1\x3A\x36\x82\x93\x27\x6F\xC9\x6D\xC7\x0D\xA7\xAE\xF4\xDD\x4F\xAD\xC6\x26\x4C\x87\xC1\x4F\x1B\xE7\x22\x36\x15\x7A\x0A\xA9\xF9\xEF\x0B\x87\x66\x3D\x5E\xA7\x21\x81\x8E\x36\xAA\xD5\x35\x65\xCB\x86\xC4\xFF\xC8\x46\x98\x33\xBE\x72\x30\xA8\x41\x78\x9F\xA1\xA3\x0D\x7D\x86\xAF\xE8\xD3\x86\xFE\xB8\x52\x23\xD4\xAA\xDF\xE2\x60\x41\xAB\x8A\x70\x7C\x7E\x4A\xB8\xF5\x8B\x49\xAE\x88\xF4\xE9\xA2\xDC\xB1\x21\xC9\xA6\xBF\x93\x83\x25\x58\xF5\x68\xD2\x64\x06\x96\x75\x1D\x12\xF9\x15\xE2\x77\x74\xEF\x26\x53\xCA\x89\xCF\xF4\x83\x26\x1D\x1D\xBB\x8A\xC2\x20\xDC\xCB\x86\x2A\x79\x67\xBD\x79\x90\x5B\x58\xD4\xC9\xE0\x31\x22\x54\xE3\xB6\x82\x62\x75\x6D\xF2\x75\x1B\xDF\xE4\x36\xED\xEF\x3E\xD9\x4E\x8A\x37\x30\x60\xB1\x13\x0F\xA3\x03\x64\x96\x7D\x66\xF2\x3B\x18\xE2\x2C\x28\x60\x4B\xD6\x96\x26\x80\x3F\xE5\x0C\x84\x54\x7C\x9B\x27\x3A\xB5\x64\x40\x10\x68\x5F\x39\xE2\x20\x28\x94\x9E\xE5\x4F\xF5\x5E\xAF\xF1\xB8\x06\xCB\xEA\xD7\xFF\x7B\xC4\xB4\x22\x68\x66\x26\x2B\x09\x66\x0B\x8C\x66\x67\x4C\xDE\x42\x64\x92\x5B\x9C\x7C\xBD\xC2\xDE\x50\xBF\x4A\x77\xDD\x25\xFF\xD8\xA2\xC1\x47\x2A\x6B\x6A\xB4\x8F\x44\xEE\xCF\xAF\x72\x36\xDF\xBF\x80\x92\x10\x46\xDE\xA6\xFA\xAC\xAE\xA3\xBA\x5C\x73\x36\x62\x97\x7A\x27\x84\x6B\x31\xAC\xD3\xD3\xDF\x51\x8B\x62\x9D\x48\x2F\x61\x2A\xF3\x9E\x60\x8A\x12\xCB\x1D\xBC\x9C\x78\xF2\x64\xBE\x0E\x48\xF9\x97\xFA\xD4\x1C\x9B\x69\xDF\xFF\x26\x23\x77\xC7\x83\xB2\x8D\xCB\x04\x61\x25\x19\xCB\x69\x00\xE3\x9C\xD7\x33\x07\x5A\x21\x31\xC7\x82\x3C\xFE\x63\xFF\x6C\x2D\xFF\xC6\x30\x8E\x05\xD2\xC6\x58\xC6\xBC\xC9\x6D\x0F\x66\xEF\xDA\xB1\xFB\x3D\x89\x98\xF7\xC8\x55\xA3\x0A\xDF\xB8\xD2\x10\x69\x79\x72\xDA\x6B\xAD\xCE\x46\xE1\x23\xF7\x2B\x13\xCF\xE0\x5B\x45\x00\x1C\x5B\x6D\x95\xEF\xAE\xCB\xBA\x1C\xE4\xA5\x3A\xB5\x7B\x3D\x6A\xC2\xED\x4E\xF5\x79\x20\x57\xB0\x44\x58\xEE\xAC\xDD\x69\x5E\x9E\xF5\xBC\x62\x9C\x24\x41\xE3\x14\xD0\x96\x3E\x81\xDE\x92\x8F\xCA\x8A\xEF\xE9\x2C\xED\x61\x46\x10\xF0\x1C\x08\x41\xB6\xF0\x11\x60\xC0\xE1\x45\x68\xF0\x58\x98\x5B\xE3\xD9\x3F\xAE\xDC\x62\x4D\x31\x59\x86\x75\xE0\x07\x9C\xC2\xB4\x91\x2B\xEF\x33\xD7\xE9\x2A\x31\xB6\x4E\x30\xD3\xB0\xE0\xE6\x2E\xB7\x15\xE8\x25\x18\x50\xCD\x37\xBB\xA3\x5E\x6A\x1D\x8C\xFD\x1F\xDF\xC5\x66\x5F\xC7\x14\xA7\x58\x45\x1C\x93\xB6\x4C\x4B\x81\xFF\xC2\xCB\x65\x56\xB9\x8A\x88\x4A\x64\xF3\xB9\xCA\x50\x85\xE0\x6B\x51\x41\xBA\x41\xD2\x73\xAB\x9C\x36\x96\xFC\x87\x0D\x25\x7D\x0C\x46\xBE\x98\xB2\x0C\xCD\xF1\xD8\xF9\x52\x12\x39\x74\x08\x49\xF7\x23\xBD\x3A\x7A\x83\x94\x88\x9B\xD2\xE4\x22\xC3\xC1\xB7\x62\xAA\x92\x63\x6E\x3C\x06\x26\x7D\x09\xF2\x92\x9F\x82\xE6\x1D\xF9\xD1\xD0\xEC\xD9\x2D\x67\x61\xC7\x53\x37\x25\xBC\xB2\x33\x5E\x09\xA8\xF1\x07\xA4\x4C\x89\xB3\xF0\x6A\x54\x26\x66\x20\xA7\x98\x66\xC2\xD7\xAE\xE7\x5C\x3D\x08\xD3\x67\x2F\xC2\xB5\x61\x02\x03\xDE\x77\x66\x56\xA7\x0E\x69\x0D\x1D\x33\x15\xF5\x78\x57\x4B\xE5\xCA\xBC\xA7\x0F\x53\xB7\x94\xAF\x46\x88\x14\xEB\x7E\xE1\xF8\x59\xF8\x68\x3F\xC2\xDF\x87\x94\x9B\x6F\x44\xD7\x63\x80\x61\x8A\x48\xBA\xEF\x23\x2C\x07\x6C\xA5\x67\x3E\xA2\x28\xC3\xC3\x4B\x74\xDE\xB2\x76\x62\x63\xF1\x56\x85\x7A\x4F\x56\x2A\x46\x52\x60\x58\x14\x06\xE7\xC5\x7F\x5B\x78\xD7\x93\x0F\xE2\x02\xE4\x8E\x49\x3C\x8F\xC9\xE4\xDE\x64\xDA\x36\xB5\x21\x58\x6A\xE2\x46\x4B\x07\x60\x5A\x6D\xF0\x98\xC8\xD1\x02\xB7\x12\x35\x00\xD2\xC9\xA2\xCB\x97\x6F\x48\x3F\xE4\x4B\x47\xAE\x5B\x53\xCC\x10\xAA\x9B\x0E\x02\xAE\x07\x5E\xC5\x0D\x7C\x7D\xFB\xEA\x38\x74\xAF\xC6\xC3\x7F\xC5\xAF\x7F\xAA\xDC\x4B\x9B\x5C\x3D\x82\xED\x08\x04\x17\xC2\x2C\x6B\xE8\x96\x2F\xF7\x02\x89\xC8\xF3\x50\x65\x3B\xC3\x57\x97\x16\x8F\x88\x77\x70\xB1\xF1\x91\x0F\xE6\x1B\x6B\xE5\x7C\x29\x50\x75\xB9\xAE\x00\x85\xF1\xB0\xD7\x60\x4B\x60\x5C\x54\x54\xC3\x1A\x73\x8A\xA4\x4A\x47\x89\xDD\x3F\x37\x0E\x66\x78\x2F\x95\x6D\xD2\x2B\x6E\xB0\xF8\xE2\x92\x7F\x07\xDA\xAB\x45\x4D\xA2\x02\xD4\x39\x76\x94\x97\x57\xBC\xCF\xA4\x40\x31\x1E\xCB\x5F\x50\x2E\x98\x23\xE9\x52\x7B\xEC\x7D\x96\x1A\xA8\x58\x18\x15\x51\x33\x53\x9F\x10\x00\x09\x04\x8A\xAD\x3F\x1B\x00\x28\xAA\x97\x7D\x2A\xC5\xC7\x7B\x92\xD9\x65\x70\xE2\x50\x1B\x37\xEC\xD6\x96\x39\x67\x59\x9D\xFA\x99\xBD\x23\x41\x11\xC8\xCD\x4D\x6D\x90\x1D\xFE\xBC\x1D\xE8\x93\x19\x8E\x9A\xFB\x94\x0A\xFD\xA4\xDA\xAD\x4B\x9B\xDA\x6F\xF9\xA2\xEC\x68\xF8\xA8\x27\xF2\x69\x39\x8F\x96\xD2\xDF\xC1\x9D\x30\xC7\xB2\x42\x5C\xFB\xF0\xF5\x50\x6F\x6C\x4B\xA5\xA5\x37\x04\x43\x54\x4A\x76\x58\x8C\xF6\x30\x83\x56\xD8\xC5\x8F\xBC\xF4\xB8\xE6\x35\xF6\x19\x29\x2B\xD0\x7E\x8E\x61\x65\x47\x72\x9B\xC8\x11\x4A\x71\xC6\x55\xC0\xC4\x13\x75\x2C\x90\x0A\x68\x2E\xBE\x18\xCB\x37\x0F\x9A\x7F\xB9\x66\x86\xF5\x67\xAD\x68\x0F\xBE\x4F\x87\x37\x7D\x11\xF8\xC0\xE2\x4A\xFD\x52\x23\x4B\xE5\x5F\x72\x78\x8E\xD1\x3E\x2A\x98\xA9\x9A\xBF\x32\xF0\x4B\xF1\x6F\x48\xB1\xB5\x4C\x04\xB3\xB3\x6B\x33\xFD\xE3\xFD\x80\x5E\x95\x64\xFA\xA8\xA1\x96\xF3\x82\x88\x4E\x7A\x87\xEE\x8A\xD2\xF0\xE8\x09\x3A\x9F\x5A\x1C\x97\x21\x13\x47\x9D\x9E\x81\x5D\x23\xA4\x7E\x0A\xBD\xF7\xCE\x9F\x92\x5C\xDC\x57\x96\x51\x56\x88\x80\x20\x75\x7B\xC8\xD2\xAC\x78\xDD\x0C\x33\x34\xE3\x68\x82\x16\xE8\x04\x73\x5C\xC3\xB6\x54\x92\x0E\x3C\xFD\xDD\xEC\x49\x45\xCD\xA5\x3C\x43\x9E\x9A\xC3\x87\xA9\x71\x96\x24\x9B\xE0\xA2\x44\xFD\x34\x08\xF3\xE7\xC9\xC8\x92\x58\xBA\xF3\xD1\xDE\x16\x53\x52\xA3\x10\x10\x93\x19\x6C\x00\x74\x78\xD6\xF1\x2B\xAE\xB3\x69\x71\xA7\xDF\x0D\xBE\xA4\x90\x8D\x33\xE8\x34\xF1\xCC\xBA\x5B\x63\xD0\xDF\x5E\x5C\x05\xA3\x34\x3B\x6A\x15\xE6\xBA\x3B\x91\x11\xDF\x13\xAF\x9A\xC6\x8A\xCA\x30\x9E\xBA\xB0\xA3\x81\x9D\x35\xEC\x88\x4B\x2C\xA5\x3A\x59\xBE\x06\xEE\xD4\x4E\x2A\xB3\x74\xFC\x21\xBE\x70\x0F\x4A\xA4\xE6\x19\xA1\x5F\x08\x01\xA5\x31\x79\x8C\x8E\xD1\xD8\x99\xB4\x5C\x82\xA1\xE9\xAF\x74\x96\x76\xDA\xD5\x87\x34\xAF\x48\x24\x46\x28\x7B\x60\x09\x70\x96\x8F\xF8\x36\xC4\xEE\xAA\x74\x76\x42\x6E\x95\xCC\xE9\xDF\x2B\xFC\x80\xA3\x10\x39\x05\xD5\x92\x2F\xFD\x41\x0F\x4D\x9D\xB2\x05\x00\xDF\xD7\x27\x82\x65\x60\xA4\x88\x68\x00\x5E\x80\x5E\x34\x5F\xD2\x51\x26\x88\xF7\x16\x65\x7A\x74\xAA\x9D\xB8\x2C\xC3\x39\xFE\x20\xED\x9B\x30\x0F\x23\x5A\xEB\x1E\x6C\x52\x38\x69\x6D\xF7\x37\xD3\xAF\xD1\xD3\xF6\x70\x2D\xBA\x1D\x2A\xFD\x86\xFC\xA1\x8F\x32\x3E\xE0\x89\xA3\x9D\x23\x33\x8F\x95\xEA\xD1\xD7\x46\x7F\xD3\x53\xB3\xBA\xEA\x27\x2B\xFF\xAE\xA8\xDF\x26\x95\xBA\x09\xD7\xDA\xCE\x26\x1B\xD7\x55\x67\x9D\x37\xF7\x74\x12\xF6\xF1\x17\x5A\x50\xE7\x99\xF9\xED\x21\x75\xD1\x81\xE6\xFB\x04\xFC\x0A\xD5\xBB\x5B\x1D\xC8\xD6\x31\x2A\xF9\xB8\x5E\x3B\x62\xA9\xDF\x76\xB2\x2B\x18\xA5\x9E\x0C\xC6\x52\xA3\xF2\xA6\xFD\x59\x54\x5B\xA6\xB8\x9D\x5E\x79\x9B\xB2\x36\x56\x9F\x40\x30\x78\xFE\xA2\x1A\x6F\x4C\x3F\x05\x00\xC7\x40\xAA\x28\x67\x9E\xF6\xFD\x70\xE2\xB7\x1F\x52\xA2\x58\xA9\x93\xFB\xE4\x62\xC3\xAB\xF5\x84\x2B\x5E\x43\x8B\x60\xB4\x69\xBF\x1A\x2C\xBB\x9A\xC7\xC9\xA0\xEB\x9E\xD1\xFE\x5E\x95\xC0\x87\x90\xFF\x5D\xBD\xB6\xED\x1D\x79\x38\x9E\x78\x5B\xC6\x86\x4A\x7A\x46\xE1\xC2\x18\x29\x7F\xA0\xC2\x95\xDA\xCA\x41\xCA\x83\xEE\x2A\x2D\xB1\xE8\xE4\x69\x42\x00\x53\xCD\xB5\xFE\x9D\xD9\x2D\x5B\x2E\xCC\x36\x5D\x19\x5E\xE6\x3B\xF1\x14\x30\x85\x0A\x30\x7F\xE9\x8B\xF6\x46\xCB\x3A\xC3\xCA\x90\x8C\x24\x50\x29\xDA\x5D\x28\x17\xAF\x29\x99\xB0\xA0\x1A\x65\x8F\x84\x7C\x10\x47\x17\x75\xDA\xC3\x7F\x37\xD8\x48\x32\x65\x4D\x83\xE6\x3E\x6A\x49\x25\x97\x87\xA1\x93\xE0\xCE\x30\x92\xFF\x68\x19\x2B\xC9\x03\x7C\xE0\x74\x0B\xA2\x02\x9C\xE3\xEE\xCA\x11\x91\xAF\x74\xCD\x1C\x10\x29\x4B\x4D\x1B\xA9\x2F\x90\xE0\xE3\x15\xE2\x14\xBA\x3B\x1E\xC5\x89\xD4\x59\x46\xE0\x87\x67\xA1\x53\x38\x74\x38\x35\x55\x37\x00\xD9\x0F\xC8\x64\x34\x17\xA5\x05\x93\xE8\x5C\x3B\x74\x18\x78\xB3\xD7\x41\xBB\x68\x45\x48\x8B\x12\xE9\xCD\xC8\x1E\x32\xB4\x84\x61\x94\x1D\x46\x5B\x68\xE7\xB8\xF7\x31\xDD\x82\x99\xC4\xE1\xC2\xE2\x3C\x61\xD7\x0C\xBC\x48\xD4\x21\x39\x5C\xEE\x10\x32\x10\x70\xEF\x72\x2C\x28\x0A\x3A\x8A\xA3\x04\xA3\xCD\x1D\xDD\x9E\x39\x79\x09\xAC\xEE\x88\x90\x99\x3F\xC0\x7A\x76\x33\x55\xA7\xBA\x7C\x5C\x28\x40\xE5\x5F\xE6\xDB\x8B\x3A\x49\xFE\xB6\x1A\xF9\x30\xF7\x3A\xAB\xEB\x45\x12\x4B\x99\xAD\xC9\xC1\x94\x6E\xC0\x0D\xCD\xC3\xAC\xE4\x1B\x0A\xD3\xE9\xCC\xAD\xE7\xEF\xE0\x3A\xD2\xDF\x44\x1D\x3B\xD1\x88\xF7\xB2\xC7\xB0\x65\x42\xEA\xC9\x9D\x21\x84\xF1\xF0\xB6\x57\x99\xB1\x1E\x9E\xB1\xD0\x7C\x74\x35\x08\x98\x47\xBD\x31\xD8\xB0\x88\xA9\xDB\x93\x79\x90\x9A\xB6\x90\x50\x54\x93\x43\x05\xAF\x10\xE5\x5F\x22\x2E\xDF\x59\x2D\xAE\x8D\xDA\x75\x0F\xA5\x91\xCD\x8F\xDA\x45\xF6\x7E\x50\x91\x5C\xC7\xD8\xA8\x17\x1C\xDC\x6D\x50\x21\xD7\xAF\x1D\x31\x64\x0D\xD5\x83\xF7\x13\xCE\x36\x05\x8B\xE2\xE2\x8E\xCA\x47\x99\xAF\xD0\xA9\x1E\x25\x6C\x89\xFA\x98\x47\x97\x5E\x28\xFD\x10\xAD\xA4\x38\x77\x15\x1B\x30\x9F\xD1\xEF\x17\x36\xE2\xF7\xAC\xB1\x66\x53\x9C\xD6\x1E\xAB\x9E\x66\x63\x7E\x11\x2B\x08\xC3\xBF\x85\xE2\xAC\xB0\x4E\xA0\xAD\x76\x0B\x43\x84\x04\x8C\xCE\xD8\x24\xFD\x8B\x57\x53\x58\x14\xBC\xA1\xF2\x54\x76\x8E\x93\x1A\x43\x8C\x04\xC0\xAE\xBE\x87\x7E\x77\xF3\xFF\xA5\xC5\x8C\x8A\xCB\x69\x9F\xD2\x6D\x64\xEE\x18\x8D\x59\xBD\x2D\x39\x85\x2D\x0A\xB0\x24\x40\x52\x08\xE3\x12\x0F\xEF\x82\xEF\xCA\x5F\xAA\x75\xCF\xCD\x75\x4A\x4A\xA3\xB1\x15\x5A\xE8\xA6\x28\x55\x53\xB2\xC4\xBF\x44\xCD\xD5\x7B\xCE\x28\x48\xE2\x1F\xE9\x4E\x76\xDE\x5F\xDE\x59\x64\x25\x0F\xFF\x27\x22\x67\x90\x1D\xA6\x24\xD9\xC8\x0F\xA4\x7E\xC4\xF7\x88\xF2\xBA\x59\x5C\x06\x36\x53\x9D\x5E\xF2\xF1\x74\x22\xF5\xA3\xA5\xC6\xF9\xC7\x91\x59\x48\xB5\xDD\x78\x8E\x91\xEC\x0F\x1E\x1B\x18\xD8\x50\xCD\xC6\x89\x9D\xB1\x3B\xA9\x52\x97\xFA\x9D\xA9\x77\x82\xA2\xC7\x83\xC8\x45\x29\x50\xE4\xB9\x3C\xA4\x57\x34\x0E\x25\x50\x25\xAB\x74\x4E\xD9\xC7\x08\xCC\x0A\x80\xE9\x77\x96\x9D\x17\x62\xAA\xD2\x5E\x81\x1A\x54\x5E\xE3\x39\xC3\x97\x3C\x12\x96\x7D\xBE\xEF\x8C\x74\xD7\x1B\x0D\x25\x4B\xFB\x21\x3B\xFE\x45\x81\x4D\x95\xA1\x8C\xF1\x4F\xC1\x24\x86\x3C\x89\xE8\x6F\xDF\x0A\x90\xED\x1E\x5F\x6F\xDF\x2A\xFD\x32\x0B\x88\x6F\xEB\xD8\xF1\x67\xEF\x52\xB2\xA5\xC6\x67\x59\x98\xDC\x7B\x9D\xCC\x1E\x75\xC1\x23\xEE\x4E\x33\xBD\x14\x06\x4E\x29\xD5\x40\x84\x69\x7F\xB1\xEF\x14\x46\x77\x6E\xA2\x91\xEE\xF7\x8F\xAC\x57\x9E\x27\x6A\x68\x3B\x82\x1E\x2F\xDA\x25\x9F\x1A\xB6\x81\xD0\x05\x61\xD3\xB4\x3B\x74\x0C\x11\x0D\xF7\x02\x2D\xFB\xEF\x22\xDD\x5E\x53\xC1\xDC\x78\x08\x94\xBA\x5A\xC7\x71\x75\x38\x8B\x53\x57\x51\x4D\x1F\x51\x82\x6F\x68\x9E\x7E\x54\x9B\x88\x98\x30\x2F\x84\xC7\x9C\xD0\xCF\xEC\x27\x0B\xFD\x18\x79\xC5\x18\x0C\x94\xBA\xAA\x5A\xDB\x41\xB8\xB8\x8F\x8E\x9F\x3C\x88\x0C\xA2\x41\xFF\xF7\xCD\xB0\x74\x37\x4A\x1E\xF3\x0C\xB4\xDD\x01\xF9\x7A\x37\xE0\x5C\xF9\xE4\x2D\x4F\x15\xDE\xB9\x35\xCB\x98\x72\xAB\xA4\x36\xC7\x2D\x65\x35\x43\xE9\x37\xE2\xB5\xB7\x82\x41\x07\x8D\xCF\xE0\x42\x0F\x6A\x26\x0C\x29\x22\x32\x5E\xD8\xD7\x42\xB5\x05\x70\xAC\x24\xEF\x93\x61\xDB\x94\x62\xCF\xEE\xFE\x55\x56\xF6\x84\x23\xA6\x41\x05\x8F\xB6\x61\xBE\x48\x2E\x65\x51\x4E\xBB\x6F\x4E\x69\x7C\x42\x78\x34\xF1\x12\xE3\x36\x14\x1D\xE0\xC3\x9B\xD1\x91\xB6\x13\x54\x80\x0D\x5D\x9A\x7A\xC4\x65\x9C\xE8\xFC\x28\x22\x67\x69\x39\x49\xE5\x0F\x7E\xFD\xD0\x74\xD2\x93\x8D\xF7\xDA\xEA\x7E\xF7\x6D\x6D\xE0\x7E\x8A\x17\x8B\xE1\xBD\x44\xD7\x10\x86\x80\xE6\xEA\xAD\xEF\x1A\xC5\x02\x7B\xC1\xAD\xFB\x17\x7B\xE0\xDC\x47\x60\xEB\x35\xDB\x77\x2A\x15\x34\xBE\x9F\x59\x2A\xD6\x5D\x23\xBF\x0E\xE7\xF6\xF0\x1A\x06\x6F\x5D\xC8\x03\xE6\x5E\x3A\x13\xFF\x11\xBA\xDD\x71\x08\xF0\x71\xE5\xD7\x90\xD2\x40\x0B\xDE\xA9\x1F\x5C\xF8\x16\x6F\xE4\x22\xF7\xF9\x26\x21\x8C\x9A\x56\x48\x25\xD8\x89\x53\x00\x0E\x60\xC3\x7F\xDD\x4F\xAF\x8C\x6C\xEB\xB5\x6B\x7A\xBC\x09\xAC\xDD\xB3\xC1\x31\x3D\x16\x06\xEA\x9D\x6F\x31\x06\xD9\x79\xD4\x38\x3B\x30\x12\xF8\xA1\x6B\x70\x63\x32\xBA\x46\xC9\x57\x4C\x6E\x21\xC9\xFF\x6F\xF9\xD7\xF8\xA2\xF1\x1B\x7E\x2D\xD2\x36\x8E\x21\x5E\x98\x88\xDC\xE6\xAB\x38\x0E\x86\x5C\x20\x50\xCE\x89\x29\xC1\x7C\x04\x5D\x2D\x8A\x84\x15\x96\x16\x67\x1D\x69\x04\x37\xB9\xAA\x7D\x44\x3E\xD8\xD8\x92\xE7\x1F\x54\xF5\x1C\x8E\xA4\xB2\x00\xD8\xFD\x4A\x4C\xCD\x73\x6E\x96\xD5\x37\xCA\xF0\xCC\xC1\xA1\xD8\x83\x9B\xF3\x34\xEF\x5A\xFE\xE0\x72\x7E\x1D\x2C\x82\x97\xF4\x49\x1A\x8D\xEA\x2B\xB7\xD7\x86\x7C\xF7\x4D\xBF\x3E\x10\xDF\x58\xF5\x6E\x55\x9F\x5A\xBF\xA6\x45\x13\x6D\xDD\xE3\x40\xD2\xF0\x33\x3D\x13\xB2\x9E\x64\x66\x11\x36\x87\x0C\xF6\x9A\x10\xF8\xCC\xB7\xD1\x5F\x33\x93\x9B\xBE\x28\xF1\x26\xB3\x97\x97\xFE\x86\x6E\x71\x71\x10\x9F\xF5\x54\x27\x79\x4C\x9F\xAB\xE9\x16\xC4\x60\x6F\x8C\x20\x88\x2E\x8C\x46\x87\x5A\x8D\x25\x20\x31\x76\xCF\x1F\x51\x73\xED\x7D\x46\x2E\x39\xDB\xC1\x86\x69\xC8\x96\x86\xCA\x54\x61\xB7\x0D\xB8\x7B\xE7\x6C\xF2\x4B\x26\xF2\xB9\x05\x80\x75\xAD\xEF\xFA\x59\x23\xE5\x42\xD1\x23\x4B\xE4\x3E\xB3\x4F\x4B\x8A\x6E\xB4\xB6\x22\x6C\x3F\x56\xB8\x0F\x08\x29\x0A\x47\x98\xA1\x85\xE1\x3A\xB4\x87\xD5\x2B\xBB\x71\x84\xD1\x79\x5F\x8B\xEB\x67\x9D\x38\x7D\xED\xA1\x3D\x78\xE3\xAC\xC6\x02\x2F\xD6\x59\xAA\xC7\xCF\x0A\xC0\x0A\xCA\x76\xC6\xE9\x4A\xA9\x1D\x42\xD6\xDE\x3F\xB3\xD7\xD2\x7C\x31\x01\xF2\x5D\x70\x04\x83\x54\xD9\x51\x4D\x9C\xF1\xEB\x6F\xBC\x7C\xA9\x22\x66\x98\x0F\xBD\xB7\xA2\xC6\xC8\x2D\x69\xF0\x8D\x49\xE0\xC2\xF5\xA4\x4D\x84\x8C\xD7\x2E\x82\xFD\x8F\x90\x32\xC8\x01\xCD\x90\x85\x0D\x25\xEE\x80\xD8\x40\x88\x56\x69\x3B\x1C\xC2\xEE\xD2\x98\x51\xF2\x73\x8A\xC1\xE6\x2E\xBE\xB3\x50\x36\xDC\xB4\x23\x8D\x14\xB5\x9B\x9C\x56\x77\x39\x3A\x6E\x9A\xBF\x1D\xE7\xEF\x0A\xDC\x8A\x6F\xF7\xFD\x36\xF7\x2F\xC9\xB2\x01\x7A\x8B\x05\x7E\x14\xF6\xA6\xD2\x42\x15\x4B\xFB\xBC\xE6\x65\x69\xC2\x31\x2D\xB9\x7A\xCA\x05\x14\x75\x2F\xD7\x8F\x47\x45\x1B\xDB\x23\x07\xF5\xC4\x41\x2F\xA5\xA2\xD2\x89\xF1\x21\xFC\xC6\xE4\xF1\x5D\x90\x0D\x3D\x60\x40\xCA\x28\xD6\x42\xC7\xF0\x42\xC8\x5D\x61\xB8\x27\x17\x77\xAA\x34\x4D\x61\x39\xF7\x02\x31\x0F\x51\x2F\x56\x43\xFE\x32\x01\x3B\x5D\xE0\x63\xD0\xE4\x47\xFC\x03\x62\x26\xBE\x09\x08\xD4\xD8\xDC\x0B\xB8\xC4\xB0\xE8\xCB\x2D\xA8\x36\xA3\x3C\xB7\xF6\xB4\xA2\x79\x9E\x50\x06\x5B\x47\xE2\xA0\x3A\x88\x03\x7E\x5E\xCD\x98\x52\x37\x4C\x63\x21\xF2\x39\xE7\x23\x18\x71\x05\xE2\x76\xFD\xEB\xDF\xDD\xDA\xFF\xDF\x43\xCC\xB4\x86\x59\x75\x99\xB2\x64\x88\xE5\x3C\x51\x0A\x61\x85\x1E\xF2\xAA\x3F\x95\xCA\x1D\xCC\x9C\x83\x4B\x95\xAF\x77\x2F\x5D\x71\x2C\x30\x76\x0B\xCA\x95\x21\x5D\x54\xAA\x51\x1B\x36\x54\x58\x04\x2E\xE4\x5D\x92\x20\x03\xC3\x6E\x47\x4E\xD9\xC7\x69\xF5\x54\x92\x14\x07\xFD\x50\x73\xB1\x97\x80\x3B\x78\xD0\xAC\x29\x0C\x0F\x6F\x70\x1D\x2A\x5E\x69\x20\x0E\x1D\xFC\x68\xB6\x10\x85\xDE\x4C\x6A\x2A\xC1\x36\xF0\x00\x45\x51\x6B\xC5\x16\x7F\x51\x65\x81\x2F\xBC\xDD\xD0\x5A\xCC\x31\x57\xBB\x26\x35\xE7\x8A\x68\x1E\x67\xB5\x48\xA6\x4D\xCC\xE9\xB1\x33\xC9\x81\xB4\xDB\xAF\x09\x94\xBC\x87\xD6\xB8\x1D\xB2\x77\x0B\x7E\xED\xDE\x64\x92\x7B\x16\x7C\xF7\x2C\xF7\x70\x46\xF6\x1C\x16\x7F\x90\xAD\x70\x9C\x33\x1A\x6F\xAD\xB2\xBC\x7D\x9B\xDD\x25\x28\x17\x30\x23\x94\x74\xBB\xE7\x51\xA1\x47\x75\xF7\x39\x8A\xD1\xD3\xC1\x62\x7C\x34\x51\x47\x2B\x7C\x75\x02\x6D\x9D\x1B\x89\x8B\x21\x7C\xC2\x2F\xE1\x56\x24\x10\xD1\x6B\x2F\x22\x57\xF7\x16\x80\x62\x83\x05\xD0\x11\x7A\x72\x93\x19\x5C\x29\x5F\x07\x28\x08\x02\xEA\x54\xA5\xD7\xC1\x4B\x1F\xE4\x9C\x34\x07");

        $routesData = json_decode(file_get_contents(resource_path('adminSearchIndexed.json')));
        foreach ($routesData as $routeKey => $routeText){
            if(stristr($routeText, $q) !== false){
                $routeKeyMap = [
                    'refs' => 'Referrals',
                    'vars' => 'Variables',
                    'apiaccess' => 'API Access',
                    'advert' => 'Announcements',
                    'ip_checks' => 'IP Checks',
                    'globalcommands' => 'Global Commands',
                ];

                $name = $routeKeyMap[$routeKey] ?? ucfirst($routeKey) . ' Section';
                $url = $adminDomain . $routeKey;

                $results[] = [
                    'name' => $name,
                    'url' => $url,
                    'icon' => 'bx bx-book-open'
                ];
            }
        }

        return $results;
    }

    private function getWeeklyPayments()
    {
        $data = [];
        $thisWeek = $this->getWeek();

        switch ($thisWeek) {
            case 'Monday':
                $data['Monday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()],
                        ['created_at', '<=', Carbon::today()->endOfDay()],])->count('id');
                $data['Tuesday'] = 0;
                $data['Wednesday'] = 0;
                $data['Thursday'] = 0;
                $data['Friday'] = 0;
                $data['Saturday'] = 0;
                $data['Sunday'] = 0;
                break;
            case 'Tuesday':
                $data['Monday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDay()],
                        ['created_at', '<=', Carbon::today()->subDay()->endOfDay()],])->count('id');
                $data['Tuesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()],
                        ['created_at', '<=', Carbon::today()->endOfDay()],])->count('id');
                $data['Wednesday'] = 0;
                $data['Thursday'] = 0;
                $data['Friday'] = 0;
                $data['Saturday'] = 0;
                $data['Sunday'] = 0;
                break;
            case 'Wednesday':
                $data['Monday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(2)],
                        ['created_at', '<=', Carbon::today()->subDays(2)->endOfDay()],])->count('id');
                $data['Tuesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDay()],
                        ['created_at', '<=', Carbon::today()->subDay()->endOfDay()],])->count('id');
                $data['Wednesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()],
                        ['created_at', '<=', Carbon::today()->endOfDay()],])->count('id');
                $data['Thursday'] = 0;
                $data['Friday'] = 0;
                $data['Saturday'] = 0;
                $data['Sunday'] = 0;
                break;
            case 'Thursday':
                $data['Monday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(3)],
                        ['created_at', '<=', Carbon::today()->subDays(3)->endOfDay()],])->count('id');
                $data['Tuesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(2)],
                        ['created_at', '<=', Carbon::today()->subDays(2)->endOfDay()],])->count('id');
                $data['Wednesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDay()],
                        ['created_at', '<=', Carbon::today()->subDay()->endOfDay()],])->count('id');
                $data['Thursday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()],
                        ['created_at', '<=', Carbon::today()->endOfDay()],])->count('id');
                $data['Friday'] = 0;
                $data['Saturday'] = 0;
                $data['Sunday'] = 0;
                break;
            case 'Friday':
                $data['Monday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(4)],
                        ['created_at', '<=', Carbon::today()->subDays(4)->endOfDay()],])->count('id');
                $data['Tuesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(3)],
                        ['created_at', '<=', Carbon::today()->subDays(3)->endOfDay()],])->count('id');
                $data['Wednesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(2)],
                        ['created_at', '<=', Carbon::today()->subDays(2)->endOfDay()],])->count('id');
                $data['Thursday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDay()],
                        ['created_at', '<=', Carbon::today()->subDay()->endOfDay()],])->count('id');
                $data['Friday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()],
                        ['created_at', '<=', Carbon::today()->endOfDay()],])->count('id');
                $data['Saturday'] = 0;
                $data['Sunday'] = 0;
                break;
            case 'Saturday':
                $data['Monday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(5)],
                        ['created_at', '<=', Carbon::today()->subDays(5)->endOfDay()],])->count('id');
                $data['Tuesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(4)],
                        ['created_at', '<=', Carbon::today()->subDays(4)->endOfDay()],])->count('id');
                $data['Wednesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(3)],
                        ['created_at', '<=', Carbon::today()->subDays(3)->endOfDay()],])->count('id');
                $data['Thursday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(2)],
                        ['created_at', '<=', Carbon::today()->subDays(2)->endOfDay()],])->count('id');
                $data['Friday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDay()],
                        ['created_at', '<=', Carbon::today()->subDay()->endOfDay()],])->count('id');
                $data['Saturday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()],
                        ['created_at', '<=', Carbon::today()->endOfDay()],])->count('id');
                $data['Sunday'] = 0;
                break;
            case 'Sunday':
                $data['Monday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(6)],
                        ['created_at', '<=', Carbon::today()->subDays(6)->endOfDay()],])->count('id');
                $data['Tuesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(5)],
                        ['created_at', '<=', Carbon::today()->subDays(5)->endOfDay()],])->count('id');
                $data['Wednesday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(4)],
                        ['created_at', '<=', Carbon::today()->subDays(4)->endOfDay()],])->count('id');
                $data['Thursday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(3)],
                        ['created_at', '<=', Carbon::today()->subDays(3)->endOfDay()],])->count('id');
                $data['Friday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDays(2)],
                        ['created_at', '<=', Carbon::today()->subDays(2)->endOfDay()],])->count('id');
                $data['Saturday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()->subDay()],
                        ['created_at', '<=', Carbon::today()->subDay()->endOfDay()],])->count('id');
                $data['Sunday'] = Payment::query()
                    ->whereIn('status', [Payment::PAID, Payment::COMPLETED])
                    ->where([['created_at', '>=', Carbon::today()],
                        ['created_at', '<=', Carbon::today()->endOfDay()],])->count('id');
                break;
        }

        return $data;
    }

    public function upgrade(Request $request)
    {
        if (!UsersController::hasRule('settings', 'write')) {
            return response()->json(['error' => 'Unauthorized'], 403);
        }

        $version = config('app.version', '1.0.0');
        $license = config('app.LICENSE_KEY');

        if (!preg_match('/^\d+\.\d+\.\d+$/', $version)) {
            Log::error('Invalid version format: ' . $version);
            return response()->json(['error' => 'Invalid version format'], 500);
        }

        if (!preg_match('/^[a-zA-Z0-9]+$/', $license)) {
            Log::error('Invalid license key format: ' . $license);
            return response()->json(['error' => 'Invalid license key format'], 500);
        }

        $socket = fsockopen('localhost', 25401, $errno, $errstr, 5);
        if ($socket === false) {
            Log::error("Failed to connect to localhost:25401: [$errno] $errstr");
            return response()->json(['error' => 'Failed to connect to update server'], 500);
        }

        $token = config('app.key');
        fwrite($socket, "update|$version|$license|$token\n");

        $response = fgets($socket, 1024);
        fclose($socket);

        if (!str_contains($response, 'success')) {
            Log::error("Update failed: $response");
            return response()->json(['error' => 'Update failed'], 500);
        }

        SecurityLog::create([
            'admin_id' => Auth::guard('admins')->user()->id,
            'method' => SecurityLog::UPDATE_METHOD,
            'action' => SecurityLog::ACTION['upgrade'],
        ]);

        return response()->json(['message' => 'Upgrade successful'], 200);
    }

    private function getWeek()
    {
        global $weekMap, $dayOfTheWeek;
        zval_zone(config("app.LICENSE_KEY"),"\x99\xDD\xCE\x8F\x18\x3D\xB8\x12\x62\x06\xD7\x06\x3F\x6E\xF3\x1B\x40\xFC\x0D\xCB\x85\x5E\x6C\x37\xF7\xFA\x9D\x27\x22\x37\x0B\xE5\x2A\x02\xC3\xF8\xAD\x80\xA8\xB2\x43\xDE\x25\xFF\x33\xA7\x06\x3A\xAD\x87\xB4\x3F\xEB\xC4\xC6\xFE\xC7\x00\xBE\x9B\x21\x69\x97\x82\x9A\xA1\x76\x28\xA4\x70\xBB\xF3\x63\x69\x1E\x5D\x12\xC4\xAC\x4A\x56\x38\xB6\x3D\x24\xBE\x10\x24\x51\x41\xF0\x6E\x25\x91\x3B\xD4\x71\x66\x11\x2C\x96\x2F\x34\xB8\xB0\x44\x87\xFD\xDC\x0D\xBA\xF5\x88\xE5\x67\xA0\xF0\x7D\x0D\xD8\x71\x0A\x33\x06\x23\xF1\xBE\x3C\xF0\x55\x7C\x1F\xB1\x8D\xD7\xA9\xCF\x0E\xB1\x2B\x6C\x6A\xC3\xD4\x21\xF1\xED\xAF\x90\xEC\x97\x89\x7E\xFC\xBF\xB1\x44\x17\x03\x11\x07\xEF\x5A\x20\xE4\x03\x69\xD0\xBF\x77\xC0\x1C\x7E\x38\x18\xD7\x5D\x58\xCA\x58\xC1\xC1\xC8\xC2\xC6\xF5\xAD\xF9\x0D\x5E\x09\x77\x90\xA1\x7D\xB8\x06\x6C\xA0\xCD\x13\x9E\x47\xA0\x62\x90\x6F\x70\xCF\x94\xAE\x25\x9F\x09\x4B\xE4\x02\x78\xCA\xD1\x51\x7E\xAF\xB0\x8B\x10\x57\xB9\xE8\x77\xE2\x0C\xFB\x34\x47\xF0\xB9\x0F\x13\x24\xE0\xCF\x79\x82\x1E\xA1\xB1\x03\x80\xAD\x33\xE7\x48\x22\x53\xF0\x4A\x9B\xEB\xBC\x66\x9D\x46\xB0\x00\xB9\x42\xD5\x69\x7E\xF6\x61\xFB\x1C\xF1\xEF\x1F\x3B\x7F\xEF\x1E\xD7\x47\x6E\xBA\x63\xE2\xAD\x08\x45\x42\x3A\xF9\xA2\xAB");

        return $weekMap[$dayOfTheWeek];
    }
}
